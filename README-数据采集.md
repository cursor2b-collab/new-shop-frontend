# JM273 数据采集脚本使用说明

## 方法一：从API接口采集（推荐，最快）

### 使用步骤：

1. **打开目标网站**
   - 在浏览器中访问：https://jm273.cc/#/
   - 等待页面完全加载

2. **打开开发者工具**
   - 按 `F12` 或右键点击页面选择"检查"
   - 切换到 `Console`（控制台）标签

3. **运行API采集脚本**
   - 打开文件 `data-collector-api.js`
   - 复制全部代码
   - 粘贴到浏览器控制台
   - 按 `Enter` 执行
   - 运行：`exportJm273ServicesFromAPI()`

4. **等待采集完成**
   - 脚本会自动从 `/api/services` 接口获取所有服务数据
   - 从Vue组件获取国家列表
   - 采集完成后会自动下载JSON文件
   - 文件名格式：`jm273_services_export_时间戳.json`

### 脚本功能：

- ✅ 直接从API接口获取所有服务数据（最快）
- ✅ 自动从Vue组件获取国家列表
- ✅ 自动关联服务到对应国家分类
- ✅ 生成标准格式JSON（与sf312_services_export格式一致）
- ✅ 显示采集统计信息
- ✅ 如果API失败，自动回退到Vue组件数据

### 数据格式：

生成的JSON格式与 `sf312_services_export` 一致：

```json
{
  "timestamp": "2024-01-01T12:00:00.000Z",
  "url": "https://jm273.cc",
  "siteId": null,
  "categories": [
    {
      "id": "US",
      "name": "US/美国 +1",
      "weigh": 100,
      "describe": "",
      "deletetime": null
    }
  ],
  "services": [
    {
      "id": "123",
      "name": "WhatsApp",
      "price": "0.50000",
      "sfcategory_id": "US",
      "deletetime": null,
      "categoryId": "US",
      "categoryName": "US/美国 +1"
    }
  ],
  "summary": {
    "totalCategories": 1,
    "totalServices": 1
  }
}
```

---
## 方法二：交互式手动采集（适用于API不可用时）

### 使用步骤：

1. **打开目标网站**
   - 在浏览器中访问：https://jm273.cc/#/
   - 等待页面完全加载

2. **打开开发者工具**
   - 按 `F12` 或右键点击页面选择"检查"
   - 切换到 `Console`（控制台）标签

3. **运行交互式采集脚本**
   - 打开文件 `data-collector-v2.js`
   - 复制全部代码
   - 粘贴到浏览器控制台
   - 按 `Enter` 执行

4. **手动选择国家采集**
   - 脚本会自动监听国家选择变化
   - **手动点击选择国家**，脚本会自动采集该国家的业务数据
   - 采集完成后，**手动选择下一个国家**，继续采集
   - 所有国家采集完成后，输入 `finish()` 导出数据

### 脚本功能：

- ✅ 自动采集所有国家列表
- ✅ 交互式采集：手动选择国家，脚本自动采集业务
- ✅ 提取业务名称和价格
- ✅ 自动导出为标准格式JSON（sf312_services_export格式）
- ✅ 显示采集进度和统计信息

### 控制命令：

- `finish()` - 完成采集并导出JSON文件
- `showData()` - 查看已采集的数据
- `reset()` - 重置采集数据

---
## 方法三：浏览器控制台脚本（旧版，已弃用）

### 使用步骤：

1. **打开目标网站**
   - 在浏览器中访问：https://jm273.cc/#/
   - 等待页面完全加载

2. **打开开发者工具**
   - 按 `F12` 或右键点击页面选择"检查"
   - 切换到 `Console`（控制台）标签

3. **运行采集脚本**
   - 打开文件 `data-collector.js`
   - 复制全部代码
   - 粘贴到浏览器控制台
   - 按 `Enter` 执行

4. **等待采集完成**
   - 脚本会自动采集所有国家和业务数据
   - 采集完成后会自动下载JSON文件
   - 文件名格式：`jm273_data_时间戳.json`

### 脚本功能：

- ✅ 自动采集所有国家列表
- ✅ 对每个国家采集业务数据
- ✅ 提取业务名称和价格
- ✅ 自动导出为JSON格式
- ✅ 显示采集进度和统计信息

---

## 方法四：Tampermonkey 用户脚本

### 安装步骤：

1. **安装 Tampermonkey 扩展**
   - Chrome: https://chrome.google.com/webstore/detail/tampermonkey
   - Firefox: https://addons.mozilla.org/firefox/addon/tampermonkey/
   - Edge: https://microsoftedge.microsoft.com/addons/detail/tampermonkey

2. **安装脚本**
   - 打开 Tampermonkey 管理面板
   - 点击"创建新脚本"
   - 复制 `data-collector-userscript.js` 的内容
   - 保存脚本

3. **使用脚本**
   - 访问 https://jm273.cc/#/
   - 页面右上角会出现"数据采集器"控制面板
   - 点击"开始采集"按钮
   - 等待采集完成，数据会自动下载

### 脚本功能：

- ✅ 可视化控制面板
- ✅ 实时显示采集进度
- ✅ 一键开始采集
- ✅ 手动导出数据
- ✅ 自动保存采集结果

---

## 注意事项

1. **网络延迟**
   - 如果网站响应较慢，脚本会自动等待
   - 建议在网络良好的环境下使用

2. **页面结构变化**
   - 如果网站更新了页面结构，可能需要调整脚本
   - 检查控制台的错误信息

3. **数据准确性**
   - 建议在采集后检查数据完整性
   - 可以多次采集对比结果

4. **浏览器兼容性**
   - 推荐使用 Chrome、Firefox 或 Edge
   - 确保浏览器支持 ES6+ 语法

---

## 故障排除

### 问题：找不到国家输入框

**解决方案：**
- 检查页面是否完全加载
- 尝试刷新页面后重新运行脚本
- 查看控制台错误信息

### 问题：采集不到业务数据

**解决方案：**
- 确认已选择国家
- 检查网络连接
- 尝试手动点击业务输入框后再运行脚本

### 问题：数据导出失败

**解决方案：**
- 检查浏览器下载权限
- 尝试手动复制控制台输出的数据
- 使用 Tampermonkey 脚本版本

---

## 技术支持

如有问题，请检查：
1. 浏览器控制台的错误信息
2. 网络请求是否正常
3. 页面元素是否发生变化

